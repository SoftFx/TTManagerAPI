---
title: <b> "Get all trade users by Group" </b> 
author: "Yury Maisiayonak"
date: '`r Sys.time()`'
output: html_document 
params: 
    server: "exchange.tts.st.soft-fx.eu"
    login: "12350"
    password: "123qwe!"
    startDate: "2017-06-21"
    groupsFilter: "Test*"
    excludeAccounts: "100180,100183,100184,100185,100186"
    skipCancelled: FALSE
    path: "."
        
---
```{r setup, cache = FALSE, echo = FALSE, message = FALSE, warning = FALSE, tidy = FALSE, results='hide'}

library(lubridate) 
library(data.table) 
library(DT) 
library(knitr) 

library(rTTManApi)
options(scipen = 999)

source("common.R")

from <- as.Date(params$startDate)
to<- from + days(1)

trades <- GetAllTrades(params$server, params$login, params$password, from, to, params$groupsFilter, params$excludeAccounts, params$skipCancelled)
trades <- trades[(TradeSide == "Buy" | TradeSide == "Sell"),.(TradeOrderId, TradeAccountId, TradeBalanceCurrency, TradeOrderCreated, TradeSide, TradeSymbol,  TradeOrderAmount=TradeOrderAmount/100, TradeOrderPrice,  TradePosClosed, TradePosClosePrice, TradeUserComment)]


```
Server: _`r params$server`_.

Login: _`r params$login`_.

Password: _`r params$password`_.

Period: _`r as.Date(from)`_ - _`r as.Date(to)`_.

Groups Filter: _`r params$groupsFilter`_.

Excluded Accounts: _`r params$excludeAccounts`_.

Skip Cancelled: _`r params$skipCancelled`_.

```{r echo=FALSE}
  
    write.csv(trades, file = file.path(params$path, paste("TradeReports from", from, " to ", to,".csv" )))
    datatable(trades)
```
